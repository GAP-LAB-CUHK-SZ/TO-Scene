(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-cuhk-cuhk-projects-viewer"],{"00e3":function(e,t,n){var a=n("a409");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("4f06").default;r("94b1b0b2",a,!0,{sourceMap:!1,shadowMode:!1})},"0ead":function(e,t,n){"use strict";n.r(t);var a=n("cd15"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},1737:function(e,t,n){n("d3b7"),n("ddb0"),e.exports=function(e){function t(t,n){this.object=t,this.domElement=void 0!==n?n:document,this.enabled=!0,this.target=new e.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:e.MOUSE.LEFT,ZOOM:e.MOUSE.MIDDLE,PAN:e.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.reset=function(){a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),a.dispatchEvent(r),a.update(),c=s.NONE},this.update=function(){var n=new e.Vector3,o=(new e.Quaternion).setFromUnitVectors(t.up,new e.Vector3(0,1,0)),i=o.clone().inverse(),f=new e.Vector3,v=new e.Quaternion;return function(){var e=a.object.position;return n.copy(e).sub(a.target),n.applyQuaternion(o),u.setFromVector3(n),a.autoRotate&&c===s.NONE&&k(L()),u.theta+=d.theta,u.phi+=d.phi,u.theta=Math.max(a.minAzimuthAngle,Math.min(a.maxAzimuthAngle,u.theta)),u.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=h,u.radius=Math.max(a.minDistance,Math.min(a.maxDistance,u.radius)),a.target.add(p),n.setFromSpherical(u),n.applyQuaternion(i),e.copy(a.target).add(n),a.object.lookAt(a.target),!0===a.enableDamping?(d.theta*=1-a.dampingFactor,d.phi*=1-a.dampingFactor):d.set(0,0,0),h=1,p.set(0,0,0),!!(m||f.distanceToSquared(a.object.position)>l||8*(1-v.dot(a.object.quaternion))>l)&&(a.dispatchEvent(r),f.copy(a.object.position),v.copy(a.object.quaternion),m=!1,!0)}}(),this.dispose=function(){a.domElement.removeEventListener("contextmenu",ae,!1),a.domElement.removeEventListener("mousedown",q,!1),a.domElement.removeEventListener("wheel",Q,!1),a.domElement.removeEventListener("touchstart",ee,!1),a.domElement.removeEventListener("touchend",ne,!1),a.domElement.removeEventListener("touchmove",te,!1),document.removeEventListener("mousemove",J,!1),document.removeEventListener("mouseup",K,!1),window.removeEventListener("keydown",$,!1)};var a=this,r={type:"change"},o={type:"start"},i={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},c=s.NONE,l=1e-6,u=new e.Spherical,d=new e.Spherical,h=1,p=new e.Vector3,m=!1,f=new e.Vector2,v=new e.Vector2,b=new e.Vector2,g=new e.Vector2,w=new e.Vector2,y=new e.Vector2,x=new e.Vector2,E=new e.Vector2,j=new e.Vector2;function L(){return 2*Math.PI/60/60*a.autoRotateSpeed}function O(){return Math.pow(.95,a.zoomSpeed)}function k(e){d.theta-=e}function M(e){d.phi-=e}var S=function(){var t=new e.Vector3;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),p.add(t)}}(),P=function(){var t=new e.Vector3;return function(e,n){t.setFromMatrixColumn(n,1),t.multiplyScalar(e),p.add(t)}}(),A=function(){var t=new e.Vector3;return function(n,r){var o=a.domElement===document?a.domElement.body:a.domElement;if(a.object instanceof e.PerspectiveCamera){var i=a.object.position;t.copy(i).sub(a.target);var s=t.length();s*=Math.tan(a.object.fov/2*Math.PI/180),S(2*n*s/o.clientHeight,a.object.matrix),P(2*r*s/o.clientHeight,a.object.matrix)}else a.object instanceof e.OrthographicCamera?(S(n*(a.object.right-a.object.left)/a.object.zoom/o.clientWidth,a.object.matrix),P(r*(a.object.top-a.object.bottom)/a.object.zoom/o.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}}();function C(t){a.object instanceof e.PerspectiveCamera?h/=t:a.object instanceof e.OrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom*t)),a.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function I(t){a.object instanceof e.PerspectiveCamera?h*=t:a.object instanceof e.OrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/t)),a.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function V(e){f.set(e.clientX,e.clientY)}function T(e){x.set(e.clientX,e.clientY)}function R(e){g.set(e.clientX,e.clientY)}function F(e){v.set(e.clientX,e.clientY),b.subVectors(v,f);var t=a.domElement===document?a.domElement.body:a.domElement;k(2*Math.PI*b.x/t.clientWidth*a.rotateSpeed),M(2*Math.PI*b.y/t.clientHeight*a.rotateSpeed),f.copy(v),a.update()}function U(e){E.set(e.clientX,e.clientY),j.subVectors(E,x),j.y>0?C(O()):j.y<0&&I(O()),x.copy(E),a.update()}function z(e){w.set(e.clientX,e.clientY),y.subVectors(w,g),A(y.x,y.y),g.copy(w),a.update()}function N(e){}function D(e){e.deltaY<0?I(O()):e.deltaY>0&&C(O()),a.update()}function _(e){switch(e.keyCode){case a.keys.UP:A(0,a.keyPanSpeed),a.update();break;case a.keys.BOTTOM:A(0,-a.keyPanSpeed),a.update();break;case a.keys.LEFT:A(a.keyPanSpeed,0),a.update();break;case a.keys.RIGHT:A(-a.keyPanSpeed,0),a.update();break}}function H(e){f.set(e.touches[0].pageX,e.touches[0].pageY)}function B(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);x.set(0,a)}function Y(e){g.set(e.touches[0].pageX,e.touches[0].pageY)}function Z(e){v.set(e.touches[0].pageX,e.touches[0].pageY),b.subVectors(v,f);var t=a.domElement===document?a.domElement.body:a.domElement;k(2*Math.PI*b.x/t.clientWidth*a.rotateSpeed),M(2*Math.PI*b.y/t.clientHeight*a.rotateSpeed),f.copy(v),a.update()}function G(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);E.set(0,r),j.subVectors(E,x),j.y>0?I(O()):j.y<0&&C(O()),x.copy(E),a.update()}function W(e){w.set(e.touches[0].pageX,e.touches[0].pageY),y.subVectors(w,g),A(y.x,y.y),g.copy(w),a.update()}function X(e){}function q(e){if(!1!==a.enabled){if(e.preventDefault(),e.button===a.mouseButtons.ORBIT){if(!1===a.enableRotate)return;V(e),c=s.ROTATE}else if(e.button===a.mouseButtons.ZOOM){if(!1===a.enableZoom)return;T(e),c=s.DOLLY}else if(e.button===a.mouseButtons.PAN){if(!1===a.enablePan)return;R(e),c=s.PAN}c!==s.NONE&&(document.addEventListener("mousemove",J,!1),document.addEventListener("mouseup",K,!1),a.dispatchEvent(o))}}function J(e){if(!1!==a.enabled)if(e.preventDefault(),c===s.ROTATE){if(!1===a.enableRotate)return;F(e)}else if(c===s.DOLLY){if(!1===a.enableZoom)return;U(e)}else if(c===s.PAN){if(!1===a.enablePan)return;z(e)}}function K(e){!1!==a.enabled&&(N(e),document.removeEventListener("mousemove",J,!1),document.removeEventListener("mouseup",K,!1),a.dispatchEvent(i),c=s.NONE)}function Q(e){!1===a.enabled||!1===a.enableZoom||c!==s.NONE&&c!==s.ROTATE||(e.preventDefault(),e.stopPropagation(),D(e),a.dispatchEvent(o),a.dispatchEvent(i))}function $(e){!1!==a.enabled&&!1!==a.enableKeys&&!1!==a.enablePan&&_(e)}function ee(e){if(!1!==a.enabled){switch(e.touches.length){case 1:if(!1===a.enableRotate)return;H(e),c=s.TOUCH_ROTATE;break;case 2:if(!1===a.enableZoom)return;B(e),c=s.TOUCH_DOLLY;break;case 3:if(!1===a.enablePan)return;Y(e),c=s.TOUCH_PAN;break;default:c=s.NONE}c!==s.NONE&&a.dispatchEvent(o)}}function te(e){if(!1!==a.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===a.enableRotate)return;if(c!==s.TOUCH_ROTATE)return;Z(e);break;case 2:if(!1===a.enableZoom)return;if(c!==s.TOUCH_DOLLY)return;G(e);break;case 3:if(!1===a.enablePan)return;if(c!==s.TOUCH_PAN)return;W(e);break;default:c=s.NONE}}function ne(e){!1!==a.enabled&&(X(e),a.dispatchEvent(i),c=s.NONE)}function ae(e){e.preventDefault()}a.domElement.addEventListener("contextmenu",ae,!1),a.domElement.addEventListener("mousedown",q,!1),a.domElement.addEventListener("wheel",Q,!1),a.domElement.addEventListener("touchstart",ee,!1),a.domElement.addEventListener("touchend",ne,!1),a.domElement.addEventListener("touchmove",te,!1),window.addEventListener("keydown",$,!1),this.update()}return t.prototype=Object.create(e.EventDispatcher.prototype),t.prototype.constructor=t,Object.defineProperties(t.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),t}},"1d6d":function(e,t,n){"use strict";var a=n("4ea4");n("99af"),n("c975"),n("d81d"),n("a434"),n("acd8"),n("e25e"),n("ac1f"),n("5319"),n("1276"),n("498a"),n("eee7"),Object.defineProperty(t,"__esModule",{value:!0}),t.OBJLoader=void 0;var r=a(n("d4ec")),o=a(n("bee2")),i=a(n("262e")),s=a(n("2caf")),c=n("4921"),l=/^[og]\s*(.+)?/,u=/^mtllib /,d=/^usemtl /,h=/^usemap /,p=new c.Vector3,m=new c.Vector3,f=new c.Vector3,v=new c.Vector3,b=new c.Vector3;function g(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var n=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var a={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"===typeof n.clone){var a=n.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){var n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){var n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){var a=this.vertices,r=this.object.geometry.vertices;r.push(a[e+0],a[e+1],a[e+2]),r.push(a[t+0],a[t+1],a[t+2]),r.push(a[n+0],a[n+1],a[n+2])},addVertexPoint:function(e){var t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){var a=this.normals,r=this.object.geometry.normals;r.push(a[e+0],a[e+1],a[e+2]),r.push(a[t+0],a[t+1],a[t+2]),r.push(a[n+0],a[n+1],a[n+2])},addFaceNormal:function(e,t,n){var a=this.vertices,r=this.object.geometry.normals;p.fromArray(a,e),m.fromArray(a,t),f.fromArray(a,n),b.subVectors(f,m),v.subVectors(p,m),b.cross(v),b.normalize(),r.push(b.x,b.y,b.z),r.push(b.x,b.y,b.z),r.push(b.x,b.y,b.z)},addColor:function(e,t,n){var a=this.colors,r=this.object.geometry.colors;void 0!==a[e]&&r.push(a[e+0],a[e+1],a[e+2]),void 0!==a[t]&&r.push(a[t+0],a[t+1],a[t+2]),void 0!==a[n]&&r.push(a[n+0],a[n+1],a[n+2])},addUV:function(e,t,n){var a=this.uvs,r=this.object.geometry.uvs;r.push(a[e+0],a[e+1]),r.push(a[t+0],a[t+1]),r.push(a[n+0],a[n+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs,n=this.object.geometry.uvs;n.push(t[e+0],t[e+1])},addFace:function(e,t,n,a,r,o,i,s,c){var l=this.vertices.length,u=this.parseVertexIndex(e,l),d=this.parseVertexIndex(t,l),h=this.parseVertexIndex(n,l);if(this.addVertex(u,d,h),this.addColor(u,d,h),void 0!==i&&""!==i){var p=this.normals.length;u=this.parseNormalIndex(i,p),d=this.parseNormalIndex(s,p),h=this.parseNormalIndex(c,p),this.addNormal(u,d,h)}else this.addFaceNormal(u,d,h);if(void 0!==a&&""!==a){var m=this.uvs.length;u=this.parseUVIndex(a,m),d=this.parseUVIndex(r,m),h=this.parseUVIndex(o,m),this.addUV(u,d,h),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,n=0,a=e.length;n<a;n++){var r=this.parseVertexIndex(e[n],t);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var n=this.vertices.length,a=this.uvs.length,r=0,o=e.length;r<o;r++)this.addVertexLine(this.parseVertexIndex(e[r],n));for(var i=0,s=t.length;i<s;i++)this.addUVLine(this.parseUVIndex(t[i],a))}};return e.startObject("",!1),e}var w=function(e){(0,i.default)(n,e);var t=(0,s.default)(n);function n(e){var a;return(0,r.default)(this,n),a=t.call(this,e),a.materials=null,a}return(0,o.default)(n,[{key:"load",value:function(e,t,n,a){var r=this,o=new c.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{t(r.parse(n))}catch(o){a?a(o):console.error(o),r.manager.itemError(e)}}),n,a)}},{key:"setMaterials",value:function(e){return this.materials=e,this}},{key:"parse",value:function(e){var t=new g;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));for(var n=e.split("\n"),a="",r="",o=0,i=[],s="function"===typeof"".trimLeft,p=0,m=n.length;p<m;p++)if(a=n[p],a=s?a.trimLeft():a.trim(),o=a.length,0!==o&&(r=a.charAt(0),"#"!==r))if("v"===r){var f=a.split(/\s+/);switch(f[0]){case"v":t.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length>=7?t.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6])):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":t.uvs.push(parseFloat(f[1]),parseFloat(f[2]));break}}else if("f"===r){for(var v=a.substr(1).trim(),b=v.split(/\s+/),w=[],y=0,x=b.length;y<x;y++){var E=b[y];if(E.length>0){var j=E.split("/");w.push(j)}}for(var L=w[0],O=1,k=w.length-1;O<k;O++){var M=w[O],S=w[O+1];t.addFace(L[0],M[0],S[0],L[1],M[1],S[1],L[2],M[2],S[2])}}else if("l"===r){var P=a.substring(1).trim().split(" "),A=[],C=[];if(-1===a.indexOf("/"))A=P;else for(var I=0,V=P.length;I<V;I++){var T=P[I].split("/");""!==T[0]&&A.push(T[0]),""!==T[1]&&C.push(T[1])}t.addLineGeometry(A,C)}else if("p"===r){var R=a.substr(1).trim(),F=R.split(" ");t.addPointGeometry(F)}else if(null!==(i=l.exec(a))){var U=(" "+i[0].substr(1).trim()).substr(1);t.startObject(U)}else if(d.test(a))t.object.startMaterial(a.substring(7).trim(),t.materialLibraries);else if(u.test(a))t.materialLibraries.push(a.substring(7).trim());else if(h.test(a))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===r){if(i=a.split(" "),i.length>1){var z=i[1].trim().toLowerCase();t.object.smooth="0"!==z&&"off"!==z}else t.object.smooth=!0;var N=t.object.currentMaterial();N&&(N.smooth=t.object.smooth)}else{if("\0"===a)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+a+'"')}t.finalize();var D=new c.Group;D.materialLibraries=[].concat(t.materialLibraries);var _=!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length);if(!0===_)for(var H=0,B=t.objects.length;H<B;H++){var Y=t.objects[H],Z=Y.geometry,G=Y.materials,W="Line"===Z.type,X="Points"===Z.type,q=!1;if(0!==Z.vertices.length){var J=new c.BufferGeometry;J.setAttribute("position",new c.Float32BufferAttribute(Z.vertices,3)),Z.normals.length>0&&J.setAttribute("normal",new c.Float32BufferAttribute(Z.normals,3)),Z.colors.length>0&&(q=!0,J.setAttribute("color",new c.Float32BufferAttribute(Z.colors,3))),!0===Z.hasUVIndices&&J.setAttribute("uv",new c.Float32BufferAttribute(Z.uvs,2));for(var K=[],Q=0,$=G.length;Q<$;Q++){var ee=G[Q],te=ee.name+"_"+ee.smooth+"_"+q,ne=t.materials[te];if(null!==this.materials)if(ne=this.materials.create(ee.name),!W||!ne||ne instanceof c.LineBasicMaterial){if(X&&ne&&!(ne instanceof c.PointsMaterial)){var ae=new c.PointsMaterial({size:10,sizeAttenuation:!1});c.Material.prototype.copy.call(ae,ne),ae.color.copy(ne.color),ae.map=ne.map,ne=ae}}else{var re=new c.LineBasicMaterial;c.Material.prototype.copy.call(re,ne),re.color.copy(ne.color),ne=re}void 0===ne&&(ne=W?new c.LineBasicMaterial:X?new c.PointsMaterial({size:1,sizeAttenuation:!1}):new c.MeshPhongMaterial,ne.name=ee.name,ne.flatShading=!ee.smooth,ne.vertexColors=q,t.materials[te]=ne),K.push(ne)}var oe=void 0;if(K.length>1){for(var ie=0,se=G.length;ie<se;ie++){var ce=G[ie];J.addGroup(ce.groupStart,ce.groupCount,ie)}oe=W?new c.LineSegments(J,K):X?new c.Points(J,K):new c.Mesh(J,K)}else oe=W?new c.LineSegments(J,K[0]):X?new c.Points(J,K[0]):new c.Mesh(J,K[0]);oe.name=Y.name,D.add(oe)}}else if(t.vertices.length>0){var le=new c.PointsMaterial({size:1,sizeAttenuation:!1}),ue=new c.BufferGeometry;ue.setAttribute("position",new c.Float32BufferAttribute(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(ue.setAttribute("color",new c.Float32BufferAttribute(t.colors,3)),le.vertexColors=!0);var de=new c.Points(ue,le);D.add(de)}return D}}]),n}(c.Loader);t.OBJLoader=w},2748:function(e,t,n){"use strict";n.r(t);var a=n("d791"),r=n("0ead");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("4920");var i,s=n("f0c5"),c=Object(s["a"])(r["default"],a["b"],a["c"],!1,null,"d86098e0",null,!1,a["a"],i);t["default"]=c.exports},3766:function(e,t,n){"use strict";var a=n("4ea4");n("c975"),n("a434"),n("acd8"),n("ac1f"),n("38cf"),n("1276"),n("498a"),Object.defineProperty(t,"__esModule",{value:!0}),t.MTLLoader=void 0;var r=a(n("d4ec")),o=a(n("bee2")),i=a(n("262e")),s=a(n("2caf")),c=n("4921"),l=function(e){(0,i.default)(n,e);var t=(0,s.default)(n);function n(e){return(0,r.default)(this,n),t.call(this,e)}return(0,o.default)(n,[{key:"load",value:function(e,t,n,a){var r=this,o=""===this.path?c.LoaderUtils.extractUrlBase(e):this.path,i=new c.FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(n){try{t(r.parse(n,o))}catch(i){a?a(i):console.error(i),r.manager.itemError(e)}}),n,a)}},{key:"setMaterialOptions",value:function(e){return this.materialOptions=e,this}},{key:"parse",value:function(e,t){for(var n=e.split("\n"),a={},r=/\s+/,o={},i=0;i<n.length;i++){var s=n[i];if(s=s.trim(),0!==s.length&&"#"!==s.charAt(0)){var c=s.indexOf(" "),l=c>=0?s.substring(0,c):s;l=l.toLowerCase();var d=c>=0?s.substring(c+1):"";if(d=d.trim(),"newmtl"===l)a={name:d},o[d]=a;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=d.split(r,3);a[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else a[l]=d}}var p=new u(this.resourcePath||t,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(o),p}}]),n}(c.Loader);t.MTLLoader=l;var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(this,e),this.baseUrl=t,this.options=n,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:c.FrontSide,this.wrap=void 0!==this.options.wrap?this.options.wrap:c.RepeatWrapping}return(0,o.default)(e,[{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setManager",value:function(e){this.manager=e}},{key:"setMaterials",value:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}},{key:"convert",value:function(e){if(!this.options)return e;var t={};for(var n in e){var a=e[n],r={};for(var o in t[n]=r,a){var i=!0,s=a[o],c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(i=!1);break;default:break}i&&(r[c]=s)}}return t}},{key:"preload",value:function(){for(var e in this.materialsInfo)this.create(e)}},{key:"getIndex",value:function(e){return this.nameLookup[e]}},{key:"getAsArray",value:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}},{key:"create",value:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}},{key:"createMaterial_",value:function(e){var t=this,n=this.materialsInfo[e],a={name:e,side:this.side};function r(e,t){return"string"!==typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}function o(e,n){if(!a[e]){var o=t.getTextureParams(n,a),i=t.loadTexture(r(t.baseUrl,o.url));i.repeat.copy(o.scale),i.offset.copy(o.offset),i.wrapS=t.wrap,i.wrapT=t.wrap,a[e]=i}}for(var i in n){var s=n[i],l=void 0;if(""!==s)switch(i.toLowerCase()){case"kd":a.color=(new c.Color).fromArray(s);break;case"ks":a.specular=(new c.Color).fromArray(s);break;case"ke":a.emissive=(new c.Color).fromArray(s);break;case"map_kd":o("map",s);break;case"map_ks":o("specularMap",s);break;case"map_ke":o("emissiveMap",s);break;case"norm":o("normalMap",s);break;case"map_bump":case"bump":o("bumpMap",s);break;case"map_d":o("alphaMap",s),a.transparent=!0;break;case"ns":a.shininess=parseFloat(s);break;case"d":l=parseFloat(s),l<1&&(a.opacity=l,a.transparent=!0);break;case"tr":l=parseFloat(s),this.options&&this.options.invertTrProperty&&(l=1-l),l>0&&(a.opacity=1-l,a.transparent=!0);break;default:break}}return this.materials[e]=new c.MeshPhongMaterial(a),this.materials[e]}},{key:"getTextureParams",value:function(e,t){var n,a={scale:new c.Vector2(1,1),offset:new c.Vector2(0,0)},r=e.split(/\s+/);return n=r.indexOf("-bm"),n>=0&&(t.bumpScale=parseFloat(r[n+1]),r.splice(n,2)),n=r.indexOf("-s"),n>=0&&(a.scale.set(parseFloat(r[n+1]),parseFloat(r[n+2])),r.splice(n,4)),n=r.indexOf("-o"),n>=0&&(a.offset.set(parseFloat(r[n+1]),parseFloat(r[n+2])),r.splice(n,4)),a.url=r.join(" ").trim(),a}},{key:"loadTexture",value:function(e,t,n,a,r){var o=void 0!==this.manager?this.manager:c.DefaultLoadingManager,i=o.getHandler(e);null===i&&(i=new c.TextureLoader(o)),i.setCrossOrigin&&i.setCrossOrigin(this.crossOrigin);var s=i.load(e,n,a,r);return void 0!==t&&(s.mapping=t),s}}]),e}()},4920:function(e,t,n){"use strict";var a=n("00e3"),r=n.n(a);r.a},a409:function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,".scene[data-v-d86098e0]{position:absolute;width:calc(100% - 60px);height:calc(100% - 104px);padding:0;box-sizing:border-box}",""]),e.exports=t},cd15:function(e,t,n){"use strict";(function(e){var a=n("dbce"),r=n("4ea4");n("c975"),n("d81d"),n("d3b7"),n("ac1f"),n("5319"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("96cf");var o=r(n("1da1")),i=a(n("4921")),s=n("fb07"),c=n("1d6d"),l=n("3766"),u=e.database(),d=(u.command,n("1737")(i));i.OrbitControls=d;var h={data:function(){return{projectData:null,curscene:null,curtable:null,editScene:{scene:null,camera:null,renderer:null,controls:null,mesh:null,objects:[]},viewportInfo:null,server:"//editor.cuhk.shensiai.com",itemCount:999,isLoading:!1}},onLoad:function(e){this.itemCount=999;var t=e.id;this.getDetail(t)},methods:{getDetail:function(e){var t=this;uni.showLoading({mask:!0,title:"正在加载场景..."}),u.collection("cuhk-projects").doc(e).field("scenename,semantic,instance,objectlist,center,create_date").get().then((function(e){var n=e.result.data[0];n&&(t.projectData=n,null==t.editScene.renderer?t.init():t.loadEditScene())})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})})).finally((function(){}))},init:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$utils.getElementInfo("editScene");case 2:e.viewportInfo=t.sent,e.isLoading=!0,n=document.getElementById("editScene"),e.initScene(n,e.editScene),e.loadEditScene();case 7:case"end":return t.stop()}}),t)})))()},initScene:function(e,t){var n=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var r,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=n.viewportInfo.width/n.viewportInfo.height,t.renderer=new i.WebGLRenderer({antialias:!0}),t.renderer.setPixelRatio(window.devicePixelRatio),t.renderer.setSize(n.viewportInfo.width,n.viewportInfo.height),t.renderer.shadowMap.enabled=!0,e.appendChild(t.renderer.domElement),t.scene=new i.Scene,t.scene.background=new i.Color(10526880),t.camera=new i.PerspectiveCamera(50,r,.1,1e3),t.camera.position.set(4.353,3.818,1.723),t.camera.up=new i.Vector3(0,0,1),o=new i.HemisphereLight(16777215,4473924),o.position.set(0,200,0),t.scene.add(o),s=new i.DirectionalLight(16777215),s.position.set(0,200,100),s.castShadow=!0,s.shadow.camera.top=180,s.shadow.camera.bottom=-100,s.shadow.camera.left=-120,s.shadow.camera.right=120,t.scene.add(s);case 22:case"end":return a.stop()}}),a)})))()},loadEditScene:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:null!=e.editScene.mesh&&e.editScene.scene.remove(e.editScene.mesh),e.editScene.objects.map((function(t){e.editScene.scene.remove(t)})),e.editScene.objects=[],e.center=new i.Vector3(e.projectData.center.x,e.projectData.center.y,e.projectData.center.z),e.editScene.camera.lookAt(e.center),null==e.editScene.controls&&(e.editScene.controls=new i.OrbitControls(e.editScene.camera,e.editScene.renderer.domElement)),e.editScene.controls.target=e.center,e.editScene.controls.update(),e.editScene.camera.updateMatrixWorld(),e.editScene.camera.updateProjectionMatrix(),n=new s.PLYLoader,n.load(e.server+"/static/models/scenes/"+e.projectData.scenename+"/"+e.projectData.scenename+".ply",e.projectData.instance,(function(t){t.computeVertexNormals();var n=new i.MeshPhongMaterial({color:16777215,specular:273,shininess:10,vertexColors:i.VertexColors});e.editScene.mesh=new i.Mesh(t,n),e.editScene.mesh.position.set(0,0,0),e.editScene.mesh.scale.multiplyScalar(1),e.editScene.mesh.castShadow=!1,e.editScene.mesh.receiveShadow=!1,e.editScene.scene.add(e.editScene.mesh)})),a=JSON.parse(e.projectData.objectlist),e.itemCount=a.length,a.map((function(t){e.loadobj(t)})),window.addEventListener("resize",e.onWindowResize),e.updateScene();case 17:case"end":return t.stop()}}),t)})))()},loadobj:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:uni.showLoading({title:"正在加载小物品",mask:!0}),u.collection("cuhk-objects").where({name:e.name}).get({getOne:!0}).then((function(n){var a=n.result.data;a.path.indexOf("ModelNet")>0&&(new c.OBJLoader).load(t.server+a.path,(function(n){n.children[0].material.color.set(15251259),n.position.set(e.pos.x,e.pos.y,e.pos.z),n.scale.set(.01*e.scale,.01*e.scale,.01*e.scale),n.rotation.set(e.rotate.x*Math.PI/180,e.rotate.y*Math.PI/180,e.rotate.z*Math.PI/180),t.editScene.scene.add(n),t.itemCount--})),a.path.indexOf("ShapeNet")>0&&(new l.MTLLoader).load(t.server+a.path.replace(".obj",".mtl"),(function(n){n.preload(),(new c.OBJLoader).setMaterials(n).load(t.server+a.path,(function(n){n.position.set(e.pos.x,e.pos.y,e.pos.z),n.scale.set(.01*e.scale,.01*e.scale,.01*e.scale),n.rotation.set(e.rotate.x*Math.PI/180,e.rotate.y*Math.PI/180,e.rotate.z*Math.PI/180),t.editScene.scene.add(n),t.itemCount--}))}))}));case 2:case"end":return n.stop()}}),n)})))()},onWindowResize:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$utils.getElementInfo("editScene");case 2:e.viewportInfo=t.sent,n=e.viewportInfo.width/e.viewportInfo.height,e.editScene.camera.aspect=n,e.editScene.camera.updateProjectionMatrix(),e.editScene.renderer.setSize(e.viewportInfo.width,e.viewportInfo.height);case 7:case"end":return t.stop()}}),t)})))()},updateScene:function(){0==this.itemCount&&this.isLoading&&(uni.hideLoading(),this.isLoading=!1),requestAnimationFrame(this.updateScene),this.editScene.renderer.render(this.editScene.scene,this.editScene.camera)}}};t.default=h}).call(this,n("a9ff")["default"])},d791:function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-container"},[n("v-uni-view",{staticClass:"scene",attrs:{id:"editScene"}})],1)},o=[]},eee7:function(e,t,n){"use strict";var a=n("23e7"),r=n("58a8").start,o=n("c8d2"),i=o("trimStart"),s=i?function(){return r(this)}:"".trimStart;a({target:"String",proto:!0,forced:i},{trimStart:s,trimLeft:s})},fb07:function(e,t,n){"use strict";var a=n("4ea4");n("c19f"),n("ace4"),n("d3b7"),n("acd8"),n("e25e"),n("ac1f"),n("1276"),n("498a"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("2954"),n("649e"),n("219c"),n("b39a"),n("72f7"),Object.defineProperty(t,"__esModule",{value:!0}),t.PLYLoader=void 0;var r=a(n("d4ec")),o=a(n("bee2")),i=a(n("262e")),s=a(n("2caf")),c=n("4921"),l=function(e){(0,i.default)(n,e);var t=(0,s.default)(n);function n(e){var a;return(0,r.default)(this,n),a=t.call(this,e),a.propertyNameMapping={},a}return(0,o.default)(n,[{key:"load",value:function(e,t,n,a,r){var o=this,i=new c.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(a){try{n(o.parse(a,t))}catch(i){r?r(i):console.error(i),o.manager.itemError(e)}}),a,r)}},{key:"setPropertyNameMapping",value:function(e){this.propertyNameMapping=e}},{key:"parse",value:function(e,t){function n(e){var t=/ply([\s\S]*)end_header\r?\n/,n="",a=0,r=t.exec(e);null!==r&&(n=r[1],a=new Blob([r[0]]).size);var o,i={comments:[],elements:[],headerLength:a,objInfo:""},s=n.split("\n");function c(e,t){var n={type:e[0]};return"list"===n.type?(n.name=e[3],n.countType=e[1],n.itemType=e[2]):n.name=e[1],n.name in t&&(n.name=t[n.name]),n}for(var l=0;l<s.length;l++){var u=s[l];if(u=u.trim(),""!==u){var d=u.split(/\s+/),h=d.shift();switch(u=d.join(" "),h){case"format":i.format=d[0],i.version=d[1];break;case"comment":i.comments.push(u);break;case"element":void 0!==o&&i.elements.push(o),o={},o.name=d[0],o.count=parseInt(d[1]),o.properties=[];break;case"property":o.properties.push(c(d,p.propertyNameMapping));break;case"obj_info":i.objInfo=u;break;default:console.log("unhandled",h,d)}}}return void 0!==o&&i.elements.push(o),i}function a(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function r(e,t){for(var n=t.split(/\s+/),r={},o=0;o<e.length;o++)if("list"===e[o].type){for(var i=[],s=a(n.shift(),e[o].countType),c=0;c<s;c++)i.push(a(n.shift(),e[o].itemType));r[e[o].name]=i}else r[e[o].name]=a(n.shift(),e[o].type);return r}function o(e,t,n){var a,o={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},c=/end_header\s([\s\S]*)$/,l="";null!==(a=c.exec(e))&&(l=a[1]);for(var u=l.split("\n"),d=0,h=0,p=0;p<u.length;p++){var m=u[p];if(m=m.trim(),""!==m){h>=t.elements[d].count&&(d++,h=0);var f=r(t.elements[d].properties,m);s(o,t.elements[d].name,f,n),h++}}return i(o)}function i(e){var t=new c.BufferGeometry;return e.indices.length>0&&t.setIndex(e.indices),t.setAttribute("position",new c.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.setAttribute("normal",new c.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.setAttribute("uv",new c.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.setAttribute("color",new c.Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed(),t.setAttribute("uv",new c.Float32BufferAttribute(e.faceVertexUvs,2))),t.computeBoundingSphere(),t}function s(e,t,n,a){if("vertex"===t)e.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&e.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n&&e.uvs.push(n.s,n.t),"label"in n&&(n.label==a?e.colors.push(.1,.1,.5):e.colors.push(.5,.5,.5));else if("face"===t){var r=n.vertex_indices||n.vertex_index,o=n.texcoord;3===r.length?(e.indices.push(r[0],r[1],r[2]),o&&6===o.length&&(e.faceVertexUvs.push(o[0],o[1]),e.faceVertexUvs.push(o[2],o[3]),e.faceVertexUvs.push(o[4],o[5]))):4===r.length&&(e.indices.push(r[0],r[1],r[3]),e.indices.push(r[1],r[2],r[3]))}}function l(e,t,n,a){switch(n){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,a),2];case"uint16":case"ushort":return[e.getUint16(t,a),2];case"int32":case"int":return[e.getInt32(t,a),4];case"uint32":case"uint":return[e.getUint32(t,a),4];case"float32":case"float":return[e.getFloat32(t,a),4];case"float64":case"double":return[e.getFloat64(t,a),8]}}function u(e,t,n,a){for(var r,o={},i=0,s=0;s<n.length;s++)if("list"===n[s].type){var c=[];r=l(e,t+i,n[s].countType,a);var u=r[0];i+=r[1];for(var d=0;d<u;d++)r=l(e,t+i,n[s].itemType,a),c.push(r[0]),i+=r[1];o[n[s].name]=c}else r=l(e,t+i,n[s].type,a),o[n[s].name]=r[0],i+=r[1];return[o,i]}function d(e,t,n){for(var a,r={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},o="binary_little_endian"===t.format,c=new DataView(e,t.headerLength),l=0,d=0;d<t.elements.length;d++)for(var h=0;h<t.elements[d].count;h++){a=u(c,l,t.elements[d].properties,o),l+=a[1];var p=a[0];s(r,t.elements[d].name,p,n)}return i(r)}var h,p=this;if(e instanceof ArrayBuffer){var m=c.LoaderUtils.decodeText(new Uint8Array(e)),f=n(m);h="ascii"===f.format?o(m,f,t):d(e,f,t)}else h=o(e,n(e));return h}}]),n}(c.Loader);t.PLYLoader=l}}]);