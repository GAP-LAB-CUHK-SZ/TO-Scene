(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-cuhk-cuhk-projects-viewer"],{"0451":function(e,t,n){"use strict";n.r(t);var a=n("3951"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},3142:function(e,t,n){"use strict";var a=n("3b85"),r=n.n(a);r.a},3466:function(e,t,n){"use strict";n.r(t);var a=n("75cd"),r=n("0451");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("3142");var i,s=n("f0c5"),c=Object(s["a"])(r["default"],a["b"],a["c"],!1,null,"51676ac9",null,!1,a["a"],i);t["default"]=c.exports},3951:function(e,t,n){"use strict";(function(e,a){var r=n("dbce"),o=n("4ea4");n("d81d"),n("d3b7"),n("ac1f"),n("5319"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("96cf");var i=o(n("1da1")),s=r(n("cb57")),c=n("8196"),l=n("dee7"),u=n("f12c"),d=e.database(),h=(d.command,n("6f60")(s));s.OrbitControls=h;var m={data:function(){return{projectData:null,curscene:null,curtable:null,editScene:{scene:null,camera:null,renderer:null,controls:null,mesh:null,objects:[]},viewportInfo:null}},onLoad:function(e){var t=e.id;this.getDetail(t)},methods:{getDetail:function(e){var t=this;uni.showLoading({mask:!0}),d.collection("cuhk-projects").doc(e).field("scenename,semantic,instance,objectlist,center,create_date").get().then((function(e){var n=e.result.data[0];n&&(t.projectData=n,a("log",t.projectData," at pages/cuhk/cuhk-projects/viewer.vue:46"),t.init())})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})})).finally((function(){uni.hideLoading()}))},init:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$utils.getElementInfo("editScene");case 2:e.viewportInfo=t.sent,n=document.getElementById("editScene"),e.initScene(n,e.editScene),e.loadEditScene();case 6:case"end":return t.stop()}}),t)})))()},initScene:function(e,t){var n=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var r,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=n.viewportInfo.width/n.viewportInfo.height,t.renderer=new s.WebGLRenderer({antialias:!0}),t.renderer.setPixelRatio(window.devicePixelRatio),t.renderer.setSize(n.viewportInfo.width,n.viewportInfo.height),t.renderer.shadowMap.enabled=!0,e.appendChild(t.renderer.domElement),t.scene=new s.Scene,t.scene.background=new s.Color(10526880),t.camera=new s.PerspectiveCamera(50,r,.1,1e3),t.camera.position.set(4.353,3.818,1.723),t.camera.up=new s.Vector3(0,0,1),o=new s.HemisphereLight(16777215,4473924),o.position.set(0,200,0),t.scene.add(o),i=new s.DirectionalLight(16777215),i.position.set(0,200,100),i.castShadow=!0,i.shadow.camera.top=180,i.shadow.camera.bottom=-100,i.shadow.camera.left=-120,i.shadow.camera.right=120,t.scene.add(i);case 22:case"end":return a.stop()}}),a)})))()},loadEditScene:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.center=new s.Vector3(e.projectData.center.x,e.projectData.center.y,e.projectData.center.z),e.editScene.camera.lookAt(e.center),null==e.editScene.controls&&(e.editScene.controls=new s.OrbitControls(e.editScene.camera,e.editScene.renderer.domElement)),e.editScene.controls.target=e.center,e.editScene.controls.update(),e.editScene.camera.updateMatrixWorld(),e.editScene.camera.updateProjectionMatrix(),n=new c.PLYLoader,n.load("/static/models/scenes/"+e.projectData.scenename+"/"+e.projectData.scenename+".ply",e.projectData.instance,(function(t){t.computeVertexNormals();var n=new s.MeshPhongMaterial({color:16777215,specular:273,shininess:10,vertexColors:s.VertexColors});e.editScene.mesh=new s.Mesh(t,n),e.editScene.mesh.position.set(0,0,0),e.editScene.mesh.scale.multiplyScalar(1),e.editScene.mesh.castShadow=!1,e.editScene.mesh.receiveShadow=!1,e.editScene.scene.add(e.editScene.mesh)})),a=JSON.parse(e.projectData.objectlist),a.map((function(t){e.loadobj(t)})),window.addEventListener("resize",e.onWindowResize),e.updateScene();case 13:case"end":return t.stop()}}),t)})))()},loadobj:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a("log",e," at pages/cuhk/cuhk-projects/viewer.vue:125"),d.collection("cuhk-objects").where({name:e.name}).get({getOne:!0}).then((function(n){var a=n.result.data;(new u.MTLLoader).load(a.path.replace(".obj",".mtl"),(function(n){n.preload(),(new l.OBJLoader).setMaterials(n).load(a.path,(function(n){n.position.set(e.pos.x,e.pos.y,e.pos.z),n.scale.set(.01*e.scale,.01*e.scale,.01*e.scale),n.rotation.set(e.rotate.x*Math.PI/180,e.rotate.y*Math.PI/180,e.rotate.z*Math.PI/180),t.editScene.scene.add(n)}))}))}));case 2:case"end":return n.stop()}}),n)})))()},onWindowResize:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$utils.getElementInfo("editScene");case 2:e.viewportInfo=t.sent,n=e.viewportInfo.width/e.viewportInfo.height,e.editScene.camera.aspect=n,e.editScene.camera.updateProjectionMatrix(),e.editScene.renderer.setSize(e.viewportInfo.width,e.viewportInfo.height);case 7:case"end":return t.stop()}}),t)})))()},updateScene:function(){requestAnimationFrame(this.updateScene),this.editScene.renderer.render(this.editScene.scene,this.editScene.camera)}}};t.default=m}).call(this,n("a9ff")["default"],n("0de9")["log"])},"3b85":function(e,t,n){var a=n("69af");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("4f06").default;r("7b0980c6",a,!0,{sourceMap:!1,shadowMode:!1})},"69af":function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,".scene[data-v-51676ac9]{position:absolute;width:calc(100% - 60px);height:calc(100% - 104px);padding:0;box-sizing:border-box}",""]),e.exports=t},"6f60":function(e,t,n){(function(t){n("d3b7"),n("ddb0"),e.exports=function(e){function n(n,a){this.object=n,this.domElement=void 0!==a?a:document,this.enabled=!0,this.target=new e.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:e.MOUSE.LEFT,ZOOM:e.MOUSE.MIDDLE,PAN:e.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(o),r.update(),l=c.NONE},this.update=function(){var t=new e.Vector3,a=(new e.Quaternion).setFromUnitVectors(n.up,new e.Vector3(0,1,0)),i=a.clone().inverse(),s=new e.Vector3,v=new e.Quaternion;return function(){var e=r.object.position;return t.copy(e).sub(r.target),t.applyQuaternion(a),d.setFromVector3(t),r.autoRotate&&l===c.NONE&&M(k()),d.theta+=h.theta,d.phi+=h.phi,d.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,d.theta)),d.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=m,d.radius=Math.max(r.minDistance,Math.min(r.maxDistance,d.radius)),r.target.add(p),t.setFromSpherical(d),t.applyQuaternion(i),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(h.theta*=1-r.dampingFactor,h.phi*=1-r.dampingFactor):h.set(0,0,0),m=1,p.set(0,0,0),!!(f||s.distanceToSquared(r.object.position)>u||8*(1-v.dot(r.object.quaternion))>u)&&(r.dispatchEvent(o),s.copy(r.object.position),v.copy(r.object.quaternion),f=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",re,!1),r.domElement.removeEventListener("mousedown",J,!1),r.domElement.removeEventListener("wheel",$,!1),r.domElement.removeEventListener("touchstart",te,!1),r.domElement.removeEventListener("touchend",ae,!1),r.domElement.removeEventListener("touchmove",ne,!1),document.removeEventListener("mousemove",K,!1),document.removeEventListener("mouseup",Q,!1),window.removeEventListener("keydown",ee,!1)};var r=this,o={type:"change"},i={type:"start"},s={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},l=c.NONE,u=1e-6,d=new e.Spherical,h=new e.Spherical,m=1,p=new e.Vector3,f=!1,v=new e.Vector2,b=new e.Vector2,g=new e.Vector2,w=new e.Vector2,y=new e.Vector2,x=new e.Vector2,j=new e.Vector2,E=new e.Vector2,L=new e.Vector2;function k(){return 2*Math.PI/60/60*r.autoRotateSpeed}function O(){return Math.pow(.95,r.zoomSpeed)}function M(e){h.theta-=e}function P(e){h.phi-=e}var S=function(){var t=new e.Vector3;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),p.add(t)}}(),A=function(){var t=new e.Vector3;return function(e,n){t.setFromMatrixColumn(n,1),t.multiplyScalar(e),p.add(t)}}(),C=function(){var n=new e.Vector3;return function(a,o){var i=r.domElement===document?r.domElement.body:r.domElement;if(r.object instanceof e.PerspectiveCamera){var s=r.object.position;n.copy(s).sub(r.target);var c=n.length();c*=Math.tan(r.object.fov/2*Math.PI/180),S(2*a*c/i.clientHeight,r.object.matrix),A(2*o*c/i.clientHeight,r.object.matrix)}else r.object instanceof e.OrthographicCamera?(S(a*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),A(o*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(t("warn","WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."," at node_modules/three-orbit-controls/index.js:353"),r.enablePan=!1)}}();function T(n){r.object instanceof e.PerspectiveCamera?m/=n:r.object instanceof e.OrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*n)),r.object.updateProjectionMatrix(),f=!0):(t("warn","WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."," at node_modules/three-orbit-controls/index.js:376"),r.enableZoom=!1)}function V(n){r.object instanceof e.PerspectiveCamera?m*=n:r.object instanceof e.OrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/n)),r.object.updateProjectionMatrix(),f=!0):(t("warn","WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."," at node_modules/three-orbit-controls/index.js:397"),r.enableZoom=!1)}function I(e){v.set(e.clientX,e.clientY)}function R(e){j.set(e.clientX,e.clientY)}function _(e){w.set(e.clientX,e.clientY)}function F(e){b.set(e.clientX,e.clientY),g.subVectors(b,v);var t=r.domElement===document?r.domElement.body:r.domElement;M(2*Math.PI*g.x/t.clientWidth*r.rotateSpeed),P(2*Math.PI*g.y/t.clientHeight*r.rotateSpeed),v.copy(b),r.update()}function U(e){E.set(e.clientX,e.clientY),L.subVectors(E,j),L.y>0?T(O()):L.y<0&&V(O()),j.copy(E),r.update()}function z(e){y.set(e.clientX,e.clientY),x.subVectors(y,w),C(x.x,x.y),w.copy(y),r.update()}function N(e){}function D(e){e.deltaY<0?V(O()):e.deltaY>0&&T(O()),r.update()}function B(e){switch(e.keyCode){case r.keys.UP:C(0,r.keyPanSpeed),r.update();break;case r.keys.BOTTOM:C(0,-r.keyPanSpeed),r.update();break;case r.keys.LEFT:C(r.keyPanSpeed,0),r.update();break;case r.keys.RIGHT:C(-r.keyPanSpeed,0),r.update();break}}function H(e){v.set(e.touches[0].pageX,e.touches[0].pageY)}function Y(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);j.set(0,a)}function Z(e){w.set(e.touches[0].pageX,e.touches[0].pageY)}function G(e){b.set(e.touches[0].pageX,e.touches[0].pageY),g.subVectors(b,v);var t=r.domElement===document?r.domElement.body:r.domElement;M(2*Math.PI*g.x/t.clientWidth*r.rotateSpeed),P(2*Math.PI*g.y/t.clientHeight*r.rotateSpeed),v.copy(b),r.update()}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);E.set(0,a),L.subVectors(E,j),L.y>0?V(O()):L.y<0&&T(O()),j.copy(E),r.update()}function X(e){y.set(e.touches[0].pageX,e.touches[0].pageY),x.subVectors(y,w),C(x.x,x.y),w.copy(y),r.update()}function q(e){}function J(e){if(!1!==r.enabled){if(e.preventDefault(),e.button===r.mouseButtons.ORBIT){if(!1===r.enableRotate)return;I(e),l=c.ROTATE}else if(e.button===r.mouseButtons.ZOOM){if(!1===r.enableZoom)return;R(e),l=c.DOLLY}else if(e.button===r.mouseButtons.PAN){if(!1===r.enablePan)return;_(e),l=c.PAN}l!==c.NONE&&(document.addEventListener("mousemove",K,!1),document.addEventListener("mouseup",Q,!1),r.dispatchEvent(i))}}function K(e){if(!1!==r.enabled)if(e.preventDefault(),l===c.ROTATE){if(!1===r.enableRotate)return;F(e)}else if(l===c.DOLLY){if(!1===r.enableZoom)return;U(e)}else if(l===c.PAN){if(!1===r.enablePan)return;z(e)}}function Q(e){!1!==r.enabled&&(N(e),document.removeEventListener("mousemove",K,!1),document.removeEventListener("mouseup",Q,!1),r.dispatchEvent(s),l=c.NONE)}function $(e){!1===r.enabled||!1===r.enableZoom||l!==c.NONE&&l!==c.ROTATE||(e.preventDefault(),e.stopPropagation(),D(e),r.dispatchEvent(i),r.dispatchEvent(s))}function ee(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&B(e)}function te(e){if(!1!==r.enabled){switch(e.touches.length){case 1:if(!1===r.enableRotate)return;H(e),l=c.TOUCH_ROTATE;break;case 2:if(!1===r.enableZoom)return;Y(e),l=c.TOUCH_DOLLY;break;case 3:if(!1===r.enablePan)return;Z(e),l=c.TOUCH_PAN;break;default:l=c.NONE}l!==c.NONE&&r.dispatchEvent(i)}}function ne(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===r.enableRotate)return;if(l!==c.TOUCH_ROTATE)return;G(e);break;case 2:if(!1===r.enableZoom)return;if(l!==c.TOUCH_DOLLY)return;W(e);break;case 3:if(!1===r.enablePan)return;if(l!==c.TOUCH_PAN)return;X(e);break;default:l=c.NONE}}function ae(e){!1!==r.enabled&&(q(e),r.dispatchEvent(s),l=c.NONE)}function re(e){e.preventDefault()}r.domElement.addEventListener("contextmenu",re,!1),r.domElement.addEventListener("mousedown",J,!1),r.domElement.addEventListener("wheel",$,!1),r.domElement.addEventListener("touchstart",te,!1),r.domElement.addEventListener("touchend",ae,!1),r.domElement.addEventListener("touchmove",ne,!1),window.addEventListener("keydown",ee,!1),this.update()}return n.prototype=Object.create(e.EventDispatcher.prototype),n.prototype.constructor=n,Object.defineProperties(n.prototype,{center:{get:function(){return t("warn","THREE.OrbitControls: .center has been renamed to .target"," at node_modules/three-orbit-controls/index.js:900"),this.target}},noZoom:{get:function(){return t("warn","THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."," at node_modules/three-orbit-controls/index.js:913"),!this.enableZoom},set:function(e){t("warn","THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."," at node_modules/three-orbit-controls/index.js:920"),this.enableZoom=!e}},noRotate:{get:function(){return t("warn","THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."," at node_modules/three-orbit-controls/index.js:931"),!this.enableRotate},set:function(e){t("warn","THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."," at node_modules/three-orbit-controls/index.js:938"),this.enableRotate=!e}},noPan:{get:function(){return t("warn","THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."," at node_modules/three-orbit-controls/index.js:949"),!this.enablePan},set:function(e){t("warn","THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."," at node_modules/three-orbit-controls/index.js:956"),this.enablePan=!e}},noKeys:{get:function(){return t("warn","THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."," at node_modules/three-orbit-controls/index.js:967"),!this.enableKeys},set:function(e){t("warn","THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."," at node_modules/three-orbit-controls/index.js:974"),this.enableKeys=!e}},staticMoving:{get:function(){return t("warn","THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."," at node_modules/three-orbit-controls/index.js:985"),!this.enableDamping},set:function(e){t("warn","THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."," at node_modules/three-orbit-controls/index.js:992"),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return t("warn","THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."," at node_modules/three-orbit-controls/index.js:1003"),this.dampingFactor},set:function(e){t("warn","THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."," at node_modules/three-orbit-controls/index.js:1010"),this.dampingFactor=e}}}),n}}).call(this,n("0de9")["log"])},"75cd":function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-container"},[n("v-uni-view",{staticClass:"scene",attrs:{id:"editScene"}})],1)},o=[]},8196:function(e,t,n){"use strict";(function(e){var a=n("4ea4");n("c19f"),n("ace4"),n("d3b7"),n("acd8"),n("e25e"),n("ac1f"),n("1276"),n("498a"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("2954"),n("649e"),n("219c"),n("b39a"),n("72f7"),Object.defineProperty(t,"__esModule",{value:!0}),t.PLYLoader=void 0;var r=a(n("d4ec")),o=a(n("bee2")),i=a(n("262e")),s=a(n("2caf")),c=n("cb57"),l=function(t){(0,i.default)(a,t);var n=(0,s.default)(a);function a(e){var t;return(0,r.default)(this,a),t=n.call(this,e),t.propertyNameMapping={},t}return(0,o.default)(a,[{key:"load",value:function(t,n,a,r,o){var i=this,s=new c.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(r){try{a(i.parse(r,n))}catch(s){o?o(s):e("error",s," at node_modules/three/examples/jsm/loaders/PLYLoader.js:69"),i.manager.itemError(t)}}),r,o)}},{key:"setPropertyNameMapping",value:function(e){this.propertyNameMapping=e}},{key:"parse",value:function(t,n){function a(t){var n=/ply([\s\S]*)end_header\r?\n/,a="",r=0,o=n.exec(t);null!==o&&(a=o[1],r=new Blob([o[0]]).size);var i,s={comments:[],elements:[],headerLength:r,objInfo:""},c=a.split("\n");function l(e,t){var n={type:e[0]};return"list"===n.type?(n.name=e[3],n.countType=e[1],n.itemType=e[2]):n.name=e[1],n.name in t&&(n.name=t[n.name]),n}for(var u=0;u<c.length;u++){var d=c[u];if(d=d.trim(),""!==d){var h=d.split(/\s+/),m=h.shift();switch(d=h.join(" "),m){case"format":s.format=h[0],s.version=h[1];break;case"comment":s.comments.push(d);break;case"element":void 0!==i&&s.elements.push(i),i={},i.name=h[0],i.count=parseInt(h[1]),i.properties=[];break;case"property":i.properties.push(l(h,p.propertyNameMapping));break;case"obj_info":s.objInfo=d;break;default:e("log","unhandled",m,h," at node_modules/three/examples/jsm/loaders/PLYLoader.js:195")}}}return void 0!==i&&s.elements.push(i),s}function r(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function o(e,t){for(var n=t.split(/\s+/),a={},o=0;o<e.length;o++)if("list"===e[o].type){for(var i=[],s=r(n.shift(),e[o].countType),c=0;c<s;c++)i.push(r(n.shift(),e[o].itemType));a[e[o].name]=i}else a[e[o].name]=r(n.shift(),e[o].type);return a}function i(e,t,n){var a,r={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},i=/end_header\s([\s\S]*)$/,c="";null!==(a=i.exec(e))&&(c=a[1]);for(var u=c.split("\n"),d=0,h=0,m=0;m<u.length;m++){var p=u[m];if(p=p.trim(),""!==p){h>=t.elements[d].count&&(d++,h=0);var f=o(t.elements[d].properties,p);l(r,t.elements[d].name,f,n),h++}}return s(r)}function s(e){var t=new c.BufferGeometry;return e.indices.length>0&&t.setIndex(e.indices),t.setAttribute("position",new c.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.setAttribute("normal",new c.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.setAttribute("uv",new c.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.setAttribute("color",new c.Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed(),t.setAttribute("uv",new c.Float32BufferAttribute(e.faceVertexUvs,2))),t.computeBoundingSphere(),t}function l(e,t,n,a){if("vertex"===t)e.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&e.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n&&e.uvs.push(n.s,n.t),"label"in n&&(n.label==a?e.colors.push(.1,.1,.5):e.colors.push(.5,.5,.5));else if("face"===t){var r=n.vertex_indices||n.vertex_index,o=n.texcoord;3===r.length?(e.indices.push(r[0],r[1],r[2]),o&&6===o.length&&(e.faceVertexUvs.push(o[0],o[1]),e.faceVertexUvs.push(o[2],o[3]),e.faceVertexUvs.push(o[4],o[5]))):4===r.length&&(e.indices.push(r[0],r[1],r[3]),e.indices.push(r[1],r[2],r[3]))}}function u(e,t,n,a){switch(n){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,a),2];case"uint16":case"ushort":return[e.getUint16(t,a),2];case"int32":case"int":return[e.getInt32(t,a),4];case"uint32":case"uint":return[e.getUint32(t,a),4];case"float32":case"float":return[e.getFloat32(t,a),4];case"float64":case"double":return[e.getFloat64(t,a),8]}}function d(e,t,n,a){for(var r,o={},i=0,s=0;s<n.length;s++)if("list"===n[s].type){var c=[];r=u(e,t+i,n[s].countType,a);var l=r[0];i+=r[1];for(var d=0;d<l;d++)r=u(e,t+i,n[s].itemType,a),c.push(r[0]),i+=r[1];o[n[s].name]=c}else r=u(e,t+i,n[s].type,a),o[n[s].name]=r[0],i+=r[1];return[o,i]}function h(e,t,n){for(var a,r={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},o="binary_little_endian"===t.format,i=new DataView(e,t.headerLength),c=0,u=0;u<t.elements.length;u++)for(var h=0;h<t.elements[u].count;h++){a=d(i,c,t.elements[u].properties,o),c+=a[1];var m=a[0];l(r,t.elements[u].name,m,n)}return s(r)}var m,p=this;if(t instanceof ArrayBuffer){var f=c.LoaderUtils.decodeText(new Uint8Array(t)),v=a(f);m="ascii"===v.format?i(f,v,n):h(t,v,n)}else m=i(t,a(t));return m}}]),a}(c.Loader);t.PLYLoader=l}).call(this,n("0de9")["log"])},dee7:function(e,t,n){"use strict";(function(e){var a=n("4ea4");n("99af"),n("c975"),n("d81d"),n("a434"),n("acd8"),n("e25e"),n("ac1f"),n("5319"),n("1276"),n("498a"),n("eee7"),Object.defineProperty(t,"__esModule",{value:!0}),t.OBJLoader=void 0;var r=a(n("d4ec")),o=a(n("bee2")),i=a(n("262e")),s=a(n("2caf")),c=n("cb57"),l=/^[og]\s*(.+)?/,u=/^mtllib /,d=/^usemtl /,h=/^usemap /,m=new c.Vector3,p=new c.Vector3,f=new c.Vector3,v=new c.Vector3,b=new c.Vector3;function g(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var n=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var a={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"===typeof n.clone){var a=n.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){var n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){var n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){var a=this.vertices,r=this.object.geometry.vertices;r.push(a[e+0],a[e+1],a[e+2]),r.push(a[t+0],a[t+1],a[t+2]),r.push(a[n+0],a[n+1],a[n+2])},addVertexPoint:function(e){var t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){var a=this.normals,r=this.object.geometry.normals;r.push(a[e+0],a[e+1],a[e+2]),r.push(a[t+0],a[t+1],a[t+2]),r.push(a[n+0],a[n+1],a[n+2])},addFaceNormal:function(e,t,n){var a=this.vertices,r=this.object.geometry.normals;m.fromArray(a,e),p.fromArray(a,t),f.fromArray(a,n),b.subVectors(f,p),v.subVectors(m,p),b.cross(v),b.normalize(),r.push(b.x,b.y,b.z),r.push(b.x,b.y,b.z),r.push(b.x,b.y,b.z)},addColor:function(e,t,n){var a=this.colors,r=this.object.geometry.colors;void 0!==a[e]&&r.push(a[e+0],a[e+1],a[e+2]),void 0!==a[t]&&r.push(a[t+0],a[t+1],a[t+2]),void 0!==a[n]&&r.push(a[n+0],a[n+1],a[n+2])},addUV:function(e,t,n){var a=this.uvs,r=this.object.geometry.uvs;r.push(a[e+0],a[e+1]),r.push(a[t+0],a[t+1]),r.push(a[n+0],a[n+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs,n=this.object.geometry.uvs;n.push(t[e+0],t[e+1])},addFace:function(e,t,n,a,r,o,i,s,c){var l=this.vertices.length,u=this.parseVertexIndex(e,l),d=this.parseVertexIndex(t,l),h=this.parseVertexIndex(n,l);if(this.addVertex(u,d,h),this.addColor(u,d,h),void 0!==i&&""!==i){var m=this.normals.length;u=this.parseNormalIndex(i,m),d=this.parseNormalIndex(s,m),h=this.parseNormalIndex(c,m),this.addNormal(u,d,h)}else this.addFaceNormal(u,d,h);if(void 0!==a&&""!==a){var p=this.uvs.length;u=this.parseUVIndex(a,p),d=this.parseUVIndex(r,p),h=this.parseUVIndex(o,p),this.addUV(u,d,h),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,n=0,a=e.length;n<a;n++){var r=this.parseVertexIndex(e[n],t);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var n=this.vertices.length,a=this.uvs.length,r=0,o=e.length;r<o;r++)this.addVertexLine(this.parseVertexIndex(e[r],n));for(var i=0,s=t.length;i<s;i++)this.addUVLine(this.parseUVIndex(t[i],a))}};return e.startObject("",!1),e}var w=function(t){(0,i.default)(a,t);var n=(0,s.default)(a);function a(e){var t;return(0,r.default)(this,a),t=n.call(this,e),t.materials=null,t}return(0,o.default)(a,[{key:"load",value:function(t,n,a,r){var o=this,i=new c.FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,(function(a){try{n(o.parse(a))}catch(i){r?r(i):e("error",i," at node_modules/three/examples/jsm/loaders/OBJLoader.js:464"),o.manager.itemError(t)}}),a,r)}},{key:"setMaterials",value:function(e){return this.materials=e,this}},{key:"parse",value:function(t){var n=new g;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var a=t.split("\n"),r="",o="",i=0,s=[],m="function"===typeof"".trimLeft,p=0,f=a.length;p<f;p++)if(r=a[p],r=m?r.trimLeft():r.trim(),i=r.length,0!==i&&(o=r.charAt(0),"#"!==o))if("v"===o){var v=r.split(/\s+/);switch(v[0]){case"v":n.vertices.push(parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])),v.length>=7?n.colors.push(parseFloat(v[4]),parseFloat(v[5]),parseFloat(v[6])):n.colors.push(void 0,void 0,void 0);break;case"vn":n.normals.push(parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3]));break;case"vt":n.uvs.push(parseFloat(v[1]),parseFloat(v[2]));break}}else if("f"===o){for(var b=r.substr(1).trim(),w=b.split(/\s+/),y=[],x=0,j=w.length;x<j;x++){var E=w[x];if(E.length>0){var L=E.split("/");y.push(L)}}for(var k=y[0],O=1,M=y.length-1;O<M;O++){var P=y[O],S=y[O+1];n.addFace(k[0],P[0],S[0],k[1],P[1],S[1],k[2],P[2],S[2])}}else if("l"===o){var A=r.substring(1).trim().split(" "),C=[],T=[];if(-1===r.indexOf("/"))C=A;else for(var V=0,I=A.length;V<I;V++){var R=A[V].split("/");""!==R[0]&&C.push(R[0]),""!==R[1]&&T.push(R[1])}n.addLineGeometry(C,T)}else if("p"===o){var _=r.substr(1).trim(),F=_.split(" ");n.addPointGeometry(F)}else if(null!==(s=l.exec(r))){var U=(" "+s[0].substr(1).trim()).substr(1);n.startObject(U)}else if(d.test(r))n.object.startMaterial(r.substring(7).trim(),n.materialLibraries);else if(u.test(r))n.materialLibraries.push(r.substring(7).trim());else if(h.test(r))e("warn",'THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.'," at node_modules/three/examples/jsm/loaders/OBJLoader.js:670");else if("s"===o){if(s=r.split(" "),s.length>1){var z=s[1].trim().toLowerCase();n.object.smooth="0"!==z&&"off"!==z}else n.object.smooth=!0;var N=n.object.currentMaterial();N&&(N.smooth=n.object.smooth)}else{if("\0"===r)continue;e("warn",'THREE.OBJLoader: Unexpected line: "'+r+'"'," at node_modules/three/examples/jsm/loaders/OBJLoader.js:716")}n.finalize();var D=new c.Group;D.materialLibraries=[].concat(n.materialLibraries);var B=!(1===n.objects.length&&0===n.objects[0].geometry.vertices.length);if(!0===B)for(var H=0,Y=n.objects.length;H<Y;H++){var Z=n.objects[H],G=Z.geometry,W=Z.materials,X="Line"===G.type,q="Points"===G.type,J=!1;if(0!==G.vertices.length){var K=new c.BufferGeometry;K.setAttribute("position",new c.Float32BufferAttribute(G.vertices,3)),G.normals.length>0&&K.setAttribute("normal",new c.Float32BufferAttribute(G.normals,3)),G.colors.length>0&&(J=!0,K.setAttribute("color",new c.Float32BufferAttribute(G.colors,3))),!0===G.hasUVIndices&&K.setAttribute("uv",new c.Float32BufferAttribute(G.uvs,2));for(var Q=[],$=0,ee=W.length;$<ee;$++){var te=W[$],ne=te.name+"_"+te.smooth+"_"+J,ae=n.materials[ne];if(null!==this.materials)if(ae=this.materials.create(te.name),!X||!ae||ae instanceof c.LineBasicMaterial){if(q&&ae&&!(ae instanceof c.PointsMaterial)){var re=new c.PointsMaterial({size:10,sizeAttenuation:!1});c.Material.prototype.copy.call(re,ae),re.color.copy(ae.color),re.map=ae.map,ae=re}}else{var oe=new c.LineBasicMaterial;c.Material.prototype.copy.call(oe,ae),oe.color.copy(ae.color),ae=oe}void 0===ae&&(ae=X?new c.LineBasicMaterial:q?new c.PointsMaterial({size:1,sizeAttenuation:!1}):new c.MeshPhongMaterial,ae.name=te.name,ae.flatShading=!te.smooth,ae.vertexColors=J,n.materials[ne]=ae),Q.push(ae)}var ie=void 0;if(Q.length>1){for(var se=0,ce=W.length;se<ce;se++){var le=W[se];K.addGroup(le.groupStart,le.groupCount,se)}ie=X?new c.LineSegments(K,Q):q?new c.Points(K,Q):new c.Mesh(K,Q)}else ie=X?new c.LineSegments(K,Q[0]):q?new c.Points(K,Q[0]):new c.Mesh(K,Q[0]);ie.name=Z.name,D.add(ie)}}else if(n.vertices.length>0){var ue=new c.PointsMaterial({size:1,sizeAttenuation:!1}),de=new c.BufferGeometry;de.setAttribute("position",new c.Float32BufferAttribute(n.vertices,3)),n.colors.length>0&&void 0!==n.colors[0]&&(de.setAttribute("color",new c.Float32BufferAttribute(n.colors,3)),ue.vertexColors=!0);var he=new c.Points(de,ue);D.add(he)}return D}}]),a}(c.Loader);t.OBJLoader=w}).call(this,n("0de9")["log"])},eee7:function(e,t,n){"use strict";var a=n("23e7"),r=n("58a8").start,o=n("c8d2"),i=o("trimStart"),s=i?function(){return r(this)}:"".trimStart;a({target:"String",proto:!0,forced:i},{trimStart:s,trimLeft:s})},f12c:function(e,t,n){"use strict";(function(e){var a=n("4ea4");n("c975"),n("a434"),n("acd8"),n("ac1f"),n("38cf"),n("1276"),n("498a"),Object.defineProperty(t,"__esModule",{value:!0}),t.MTLLoader=void 0;var r=a(n("d4ec")),o=a(n("bee2")),i=a(n("262e")),s=a(n("2caf")),c=n("cb57"),l=function(t){(0,i.default)(a,t);var n=(0,s.default)(a);function a(e){return(0,r.default)(this,a),n.call(this,e)}return(0,o.default)(a,[{key:"load",value:function(t,n,a,r){var o=this,i=""===this.path?c.LoaderUtils.extractUrlBase(t):this.path,s=new c.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(a){try{n(o.parse(a,i))}catch(s){r?r(s):e("error",s," at node_modules/three/examples/jsm/loaders/MTLLoader.js:63"),o.manager.itemError(t)}}),a,r)}},{key:"setMaterialOptions",value:function(e){return this.materialOptions=e,this}},{key:"parse",value:function(e,t){for(var n=e.split("\n"),a={},r=/\s+/,o={},i=0;i<n.length;i++){var s=n[i];if(s=s.trim(),0!==s.length&&"#"!==s.charAt(0)){var c=s.indexOf(" "),l=c>=0?s.substring(0,c):s;l=l.toLowerCase();var d=c>=0?s.substring(c+1):"";if(d=d.trim(),"newmtl"===l)a={name:d},o[d]=a;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=d.split(r,3);a[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else a[l]=d}}var m=new u(this.resourcePath||t,this.materialOptions);return m.setCrossOrigin(this.crossOrigin),m.setManager(this.manager),m.setMaterials(o),m}}]),a}(c.Loader);t.MTLLoader=l;var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(this,e),this.baseUrl=t,this.options=n,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:c.FrontSide,this.wrap=void 0!==this.options.wrap?this.options.wrap:c.RepeatWrapping}return(0,o.default)(e,[{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setManager",value:function(e){this.manager=e}},{key:"setMaterials",value:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}},{key:"convert",value:function(e){if(!this.options)return e;var t={};for(var n in e){var a=e[n],r={};for(var o in t[n]=r,a){var i=!0,s=a[o],c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(i=!1);break;default:break}i&&(r[c]=s)}}return t}},{key:"preload",value:function(){for(var e in this.materialsInfo)this.create(e)}},{key:"getIndex",value:function(e){return this.nameLookup[e]}},{key:"getAsArray",value:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}},{key:"create",value:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}},{key:"createMaterial_",value:function(e){var t=this,n=this.materialsInfo[e],a={name:e,side:this.side};function r(e,t){return"string"!==typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}function o(e,n){if(!a[e]){var o=t.getTextureParams(n,a),i=t.loadTexture(r(t.baseUrl,o.url));i.repeat.copy(o.scale),i.offset.copy(o.offset),i.wrapS=t.wrap,i.wrapT=t.wrap,a[e]=i}}for(var i in n){var s=n[i],l=void 0;if(""!==s)switch(i.toLowerCase()){case"kd":a.color=(new c.Color).fromArray(s);break;case"ks":a.specular=(new c.Color).fromArray(s);break;case"ke":a.emissive=(new c.Color).fromArray(s);break;case"map_kd":o("map",s);break;case"map_ks":o("specularMap",s);break;case"map_ke":o("emissiveMap",s);break;case"norm":o("normalMap",s);break;case"map_bump":case"bump":o("bumpMap",s);break;case"map_d":o("alphaMap",s),a.transparent=!0;break;case"ns":a.shininess=parseFloat(s);break;case"d":l=parseFloat(s),l<1&&(a.opacity=l,a.transparent=!0);break;case"tr":l=parseFloat(s),this.options&&this.options.invertTrProperty&&(l=1-l),l>0&&(a.opacity=1-l,a.transparent=!0);break;default:break}}return this.materials[e]=new c.MeshPhongMaterial(a),this.materials[e]}},{key:"getTextureParams",value:function(e,t){var n,a={scale:new c.Vector2(1,1),offset:new c.Vector2(0,0)},r=e.split(/\s+/);return n=r.indexOf("-bm"),n>=0&&(t.bumpScale=parseFloat(r[n+1]),r.splice(n,2)),n=r.indexOf("-s"),n>=0&&(a.scale.set(parseFloat(r[n+1]),parseFloat(r[n+2])),r.splice(n,4)),n=r.indexOf("-o"),n>=0&&(a.offset.set(parseFloat(r[n+1]),parseFloat(r[n+2])),r.splice(n,4)),a.url=r.join(" ").trim(),a}},{key:"loadTexture",value:function(e,t,n,a,r){var o=void 0!==this.manager?this.manager:c.DefaultLoadingManager,i=o.getHandler(e);null===i&&(i=new c.TextureLoader(o)),i.setCrossOrigin&&i.setCrossOrigin(this.crossOrigin);var s=i.load(e,n,a,r);return void 0!==t&&(s.mapping=t),s}}]),e}()}).call(this,n("0de9")["log"])}}]);